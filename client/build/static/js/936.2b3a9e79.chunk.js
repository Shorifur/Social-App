"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[936],{7821:(e,s,t)=>{t.d(s,{A:()=>_});var n=t(5043),a=t(6446),r=t(8729),o=t(6536),i=t(2110),c=t(9958),l=t(7830),d=t(7392),x=t(6591),u=t(6494),p=t(5865),h=t(9336),m=t(5795),j=t(1906),g=t(6520),f=t(835),A=t(8082),b=t(853),v=t(6625);const y=(0,t(2104).io)("http://localhost:5000",{autoConnect:!1}),k=y;var w=t(579);const C=function(e){var s,t;let{post:o}=e;const{user:y}=(0,n.useContext)(r.c),[C,S]=(0,n.useState)((null===(s=o.likes)||void 0===s?void 0:s.length)||0),[I,_]=(0,n.useState)(!1),[E,R]=(0,n.useState)("");return(0,n.useEffect)(()=>(k.on("post-liked",e=>{let{postId:s,likesCount:t}=e;s===o._id&&S(t)}),()=>{k.off("post-liked")}),[o._id]),(0,w.jsxs)(i.A,{sx:{mb:3,borderRadius:"20px",background:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 4px 30px rgba(0, 0, 0, 0.1)"},children:[(0,w.jsx)(c.A,{avatar:(0,w.jsx)(l.A,{src:o.user.avatar||"/default-avatar.png"}),title:o.user.username,subheader:(0,b.m)(new Date(o.createdAt),{addSuffix:!0}),action:(0,w.jsx)(d.A,{children:(0,w.jsx)(A.A,{})}),sx:{pb:0}}),(0,w.jsx)(x.A,{component:"img",height:"500",image:o.image||"/placeholder.jpg",sx:{borderRadius:"15px",m:2,boxShadow:"4px 4px 8px #ccc, -4px -4px 8px #fff"}}),(0,w.jsxs)(u.A,{children:[(0,w.jsx)(p.A,{variant:"body1",sx:{mb:2},children:o.content}),(0,w.jsx)(h.A,{sx:{my:2}}),(0,w.jsxs)(a.A,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,w.jsx)(v.P.span,{onClick:()=>{S(I?C-1:C+1),_(!I),k.emit("like-post",{postId:o._id,userId:y._id})},whileTap:{scale:1.5},animate:{scale:I?[1,1.2,1]:1},style:{display:"inline-block",cursor:"pointer"},children:(0,w.jsx)(g.A,{color:I?"error":"disabled"})}),(0,w.jsx)(p.A,{children:C}),(0,w.jsx)(d.A,{children:(0,w.jsx)(f.A,{})}),(0,w.jsx)(p.A,{children:(null===(t=o.comments)||void 0===t?void 0:t.length)||0})]}),(0,w.jsxs)(a.A,{sx:{mt:2,display:"flex",gap:1},children:[(0,w.jsx)(m.A,{fullWidth:!0,size:"small",placeholder:"Write a comment...",value:E,onChange:e=>R(e.target.value)}),(0,w.jsx)(j.A,{variant:"contained",onClick:()=>{E.trim()&&(k.emit("send-notification",{userId:o.user._id,message:"".concat(y.username," commented on your post")}),R(""))},children:"Send"})]})]})]})};var S=t(7034);function I(){return(0,w.jsx)("div",{className:"loading-overlay",children:(0,w.jsx)(S.A,{color:"#36d7b7",size:15})})}function _(){const{user:e}=(0,n.useContext)(r.c),[s,t]=(0,n.useState)([]),[i,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{const e=await o.Ay.get("/posts");t(e.data)}catch(e){console.error("Error fetching posts:",e)}finally{c(!1)}})()},[]);const l=async()=>{try{const e=await o.Ay.get("/posts");t(e.data)}catch(e){console.error("Error refreshing posts:",e)}};return i?(0,w.jsx)(I,{}):(0,w.jsx)(a.A,{sx:{mt:2},children:s.map(s=>(0,w.jsx)(C,{post:s,currentUser:e,onInteraction:l},s._id))})}},9936:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var n=t(5043),a=t(7121),r=t(7821),o=t(8729),i=t(579);const c=function(){const{loading:e=!1}=(0,n.useContext)(o.c)||{};return(0,i.jsx)("div",{style:{padding:"2rem"},children:e?(0,i.jsx)(a.A,{variant:"rectangular",width:500,height:300,animation:"wave",sx:{borderRadius:2}}):(0,i.jsx)(r.A,{})})}}}]);
//# sourceMappingURL=936.2b3a9e79.chunk.js.map