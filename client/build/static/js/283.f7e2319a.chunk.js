"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[283],{1321:(e,s,t)=>{t.d(s,{A:()=>n});const a=t(9722).A.create({baseURL:"https://social-app-backend-5sx9.onrender.com/api",timeout:1e4,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var s;return 401===(null===(s=e.response)||void 0===s?void 0:s.status)&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)});const n=a},2266:(e,s,t)=>{t.d(s,{A:()=>n});const a=t(9722).A.create({baseURL:"https://social-app-backend-5sx9.onrender.com",timeout:1e4,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var s;return 401===(null===(s=e.response)||void 0===s?void 0:s.status)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const n=a},3283:(e,s,t)=>{t.r(s),t.d(s,{default:()=>m});var a=t(5043),n=t(6351),o=t(5028),r=t(9379),i=t(3884),c=t(1321),l=t(579);const d=()=>{const{user:e}=(0,n.A)(),[s,t]=(0,a.useState)([]),[o,d]=(0,a.useState)(!0),[m,u]=(0,a.useState)(""),[p,h]=(0,a.useState)(1),[v,j]=(0,a.useState)(!0),x=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{const s=await c.A.get("/api/posts?page=".concat(e,"&limit=10"));if("success"===s.data.status){const a=s.data.data.posts;t(s=>1===e?a:[...s,...a]),j(e<s.data.pagination.pages)}}catch(s){console.error("Error fetching posts:",s),u("Failed to load posts.")}finally{d(!1)}};(0,a.useEffect)(()=>{x()},[]);const g=async s=>{try{const a=await c.A.post("/api/posts/".concat(s,"/like"));if("success"===a.data.status){const{liked:n}=a.data.data;t(t=>t.map(t=>t._id===s?(0,r.A)((0,r.A)({},t),{},{likes:n?[...t.likes,e._id]:t.likes.filter(s=>s!==e._id)}):t))}}catch(a){console.error("Error liking post:",a)}},N=async(e,s)=>{try{const a=await c.A.post("/api/posts/".concat(e,"/comments"),{content:s});if("success"===a.data.status){const s=a.data.data.comment;t(t=>t.map(t=>t._id===e?(0,r.A)((0,r.A)({},t),{},{comments:[...t.comments,s]}):t))}}catch(a){console.error("Error adding comment:",a)}};return o&&0===s.length?(0,l.jsx)("div",{className:"loading",children:"Loading posts..."}):m?(0,l.jsx)("div",{className:"error",children:m}):(0,l.jsxs)("div",{className:"post-feed",children:[s.map(e=>(0,l.jsx)(i.A,{post:e,onLike:g,onComment:N},e._id)),v&&(0,l.jsx)("button",{className:"load-more-btn",onClick:()=>{if(!o&&v){const e=p+1;h(e),x(e)}},disabled:o,children:o?"Loading...":"Load More"})]})},m=()=>{const{user:e}=(0,n.A)(),[s,t]=(0,a.useState)(0);return(0,l.jsx)("div",{className:"dashboard",children:(0,l.jsxs)("div",{className:"dashboard-content",children:[(0,l.jsx)("aside",{className:"sidebar",children:(0,l.jsxs)("div",{className:"user-card",children:[(0,l.jsx)("img",{src:(null===e||void 0===e?void 0:e.profilePicture)||"/default-avatar.jpg",alt:(null===e||void 0===e?void 0:e.firstName)||"User",className:"user-avatar-large"}),(0,l.jsxs)("h3",{children:[null===e||void 0===e?void 0:e.firstName," ",null===e||void 0===e?void 0:e.lastName]}),(0,l.jsxs)("p",{children:["@",null===e||void 0===e?void 0:e.username]})]})}),(0,l.jsxs)("main",{className:"main-feed",children:[(0,l.jsx)(o.A,{onPostCreated:()=>{t(e=>e+1)}}),(0,l.jsx)(d,{},s)]}),(0,l.jsx)("aside",{className:"sidebar",children:(0,l.jsx)("div",{className:"trending-section",children:(0,l.jsx)("h3",{children:"Trending Topics"})})})]})})}},3884:(e,s,t)=>{t.d(s,{A:()=>m});var a=t(9379),n=t(5043),o=t(2266);const r=async(e,s)=>{try{return(await o.A.post("/api/posts/".concat(e,"/reactions"),{type:s})).data}catch(a){var t;throw(null===(t=a.response)||void 0===t?void 0:t.data)||a}},i=async e=>{try{return(await o.A.delete("/api/posts/".concat(e,"/reactions"))).data}catch(t){var s;throw(null===(s=t.response)||void 0===s?void 0:s.data)||t}},c=async e=>{try{return(await o.A.get("/api/posts/".concat(e,"/reactions/me"))).data}catch(a){var s,t;if(404===(null===(s=a.response)||void 0===s?void 0:s.status))return null;throw(null===(t=a.response)||void 0===t?void 0:t.data)||a}};var l=t(6351),d=t(579);const m=e=>{var s,t,o,m;let{post:u,onComment:p}=e;const[h,v]=(0,n.useState)(null),[j,x]=(0,n.useState)(u.reactionCounts||{}),[g,N]=(0,n.useState)(!1),[f,b]=(0,n.useState)(""),[y,w]=(0,n.useState)(!1),{user:A}=(0,l.A)(),k=async()=>{try{const e=await c(u._id);v((null===e||void 0===e?void 0:e.userReaction)||null)}catch(e){console.error("Error loading user reaction:",e)}};(0,n.useEffect)(()=>{k()},[u._id,k]);const S=async e=>{try{if(h===e)await i(u._id),v(null),x(s=>(0,a.A)((0,a.A)({},s),{},{[e]:Math.max(0,(s[e]||0)-1)}));else{const s=await r(u._id,e);v(e),x(s.reactionCounts)}N(!1)}catch(s){console.error("Error handling reaction:",s)}},C=e=>{switch(e){case"like":default:return"\ud83d\udc4d";case"love":return"\u2764\ufe0f";case"haha":return"\ud83d\ude04";case"wow":return"\ud83d\ude32";case"sad":return"\ud83d\ude22";case"angry":return"\ud83d\ude20";case"dislike":return"\ud83d\udc4e"}},P=()=>Object.values(j).reduce((e,s)=>e+s,0),L=e=>new Date(e).toLocaleDateString("en-US",{hour:"2-digit",minute:"2-digit"});return(0,d.jsxs)("div",{className:"post-card",children:[(0,d.jsxs)("div",{className:"post-header",children:[(0,d.jsx)("img",{src:(null===(s=u.user)||void 0===s?void 0:s.profilePicture)||"/default-avatar.jpg",alt:null===(t=u.user)||void 0===t?void 0:t.firstName,className:"post-avatar"}),(0,d.jsxs)("div",{className:"post-user-info",children:[(0,d.jsxs)("h4",{children:[null===(o=u.user)||void 0===o?void 0:o.firstName," ",null===(m=u.user)||void 0===m?void 0:m.lastName]}),(0,d.jsx)("span",{className:"post-time",children:L(u.createdAt)})]})]}),(0,d.jsxs)("div",{className:"post-content",children:[(0,d.jsx)("p",{children:u.content}),u.image&&(0,d.jsx)("img",{src:u.image,alt:"Post",className:"post-image"})]}),(0,d.jsxs)("div",{className:"post-stats",children:[P()>0&&(0,d.jsxs)("span",{children:[P()," reactions"]}),(0,d.jsxs)("span",{children:[u.comments.length," comments"]})]}),(0,d.jsxs)("div",{className:"post-actions",children:[(0,d.jsxs)("button",{className:"action-btn ".concat(h?"active":""),onMouseEnter:()=>N(!0),onMouseLeave:()=>N(!1),onClick:()=>S("like"),children:[h?C(h):"\ud83d\udc4d"," ",h?"Reacted":"React"]}),(0,d.jsx)("button",{onClick:()=>w(!y),className:"action-btn",children:"\ud83d\udcac Comment"}),(0,d.jsx)("button",{className:"action-btn",children:"\ud83d\udd04 Share"})]}),g&&(0,d.jsx)("div",{className:"reaction-picker",onMouseEnter:()=>N(!0),onMouseLeave:()=>N(!1),children:["like","love","haha","wow","sad","angry","dislike"].map(e=>(0,d.jsx)("button",{className:"reaction-option",onClick:()=>S(e),title:e.charAt(0).toUpperCase()+e.slice(1),children:C(e)},e))}),y&&(0,d.jsxs)("div",{className:"comments-section",children:[(0,d.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f.trim()&&(p(u._id,f.trim()),b(""))},className:"comment-form",children:[(0,d.jsx)("input",{type:"text",value:f,onChange:e=>b(e.target.value),placeholder:"Write a comment...",className:"comment-input"}),(0,d.jsx)("button",{type:"submit",disabled:!f.trim(),children:"Post"})]}),(0,d.jsx)("div",{className:"comments-list",children:u.comments.map(e=>{var s,t,a;return(0,d.jsxs)("div",{className:"comment",children:[(0,d.jsx)("img",{src:(null===(s=e.user)||void 0===s?void 0:s.profilePicture)||"/default-avatar.jpg",alt:null===(t=e.user)||void 0===t?void 0:t.firstName,className:"comment-avatar"}),(0,d.jsxs)("div",{className:"comment-content",children:[(0,d.jsx)("strong",{children:null===(a=e.user)||void 0===a?void 0:a.firstName}),(0,d.jsx)("p",{children:e.content}),(0,d.jsx)("span",{className:"comment-time",children:L(e.createdAt)})]})]},e._id)})})]})]})}},5028:(e,s,t)=>{t.d(s,{A:()=>i});var a=t(5043),n=t(6351),o=t(1321),r=t(579);const i=e=>{let{onPostCreated:s}=e;const[t,i]=(0,a.useState)(""),[c,l]=(0,a.useState)([]),[d,m]=(0,a.useState)(!1),[u,p]=(0,a.useState)(""),{user:h}=(0,n.A)();return(0,r.jsxs)("div",{className:"create-post-card",children:[(0,r.jsxs)("div",{className:"post-header",children:[(0,r.jsx)("img",{src:(null===h||void 0===h?void 0:h.profilePicture)||"/default-avatar.jpg",alt:null===h||void 0===h?void 0:h.firstName,className:"user-avatar"}),(0,r.jsxs)("div",{className:"user-info",children:[(0,r.jsxs)("h4",{children:[null===h||void 0===h?void 0:h.firstName," ",null===h||void 0===h?void 0:h.lastName]}),(0,r.jsx)("p",{children:"What\u2019s on your mind?"})]})]}),(0,r.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),m(!0),p("");try{const e=new FormData;e.append("content",t),c.forEach(s=>e.append("images",s));const a=await o.A.post("/api/posts",e,{headers:{"Content-Type":"multipart/form-data"}});a.data&&(i(""),l([]),s&&s(a.data))}catch(r){var a,n;p((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||"Failed to create post")}finally{m(!1)}},className:"post-form",children:[(0,r.jsx)("textarea",{value:t,onChange:e=>i(e.target.value),placeholder:"Share something with your community...",maxLength:1e3,rows:3,required:!0}),c.length>0&&(0,r.jsx)("div",{className:"image-preview-container",children:c.map((e,s)=>(0,r.jsxs)("div",{className:"image-preview",children:[(0,r.jsx)("img",{src:URL.createObjectURL(e),alt:"Preview ".concat(s),className:"preview-image"}),(0,r.jsx)("button",{type:"button",className:"remove-image-btn",onClick:()=>(e=>{l(s=>s.filter((s,t)=>t!==e))})(s),children:"\xd7"})]},s))}),u&&(0,r.jsx)("div",{className:"error-message",children:u}),(0,r.jsxs)("div",{className:"post-actions",children:[(0,r.jsxs)("div",{className:"action-buttons",children:[(0,r.jsx)("label",{htmlFor:"image-upload",className:"file-input-label",children:"\ud83d\udcf7 Add Photos"}),(0,r.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",multiple:!0,onChange:e=>{const s=Array.from(e.target.files).filter(e=>e.type.startsWith("image/"));0!==s.length&&l(e=>[...e,...s])},className:"file-input"})]}),(0,r.jsx)("button",{type:"submit",disabled:d||!t.trim()&&0===c.length,className:"post-button",children:d?"Posting...":"Post"})]})]})]})}},6351:(e,s,t)=>{t.d(s,{A:()=>o});var a=t(5043);t(9722);t(579);const n=(0,a.createContext)(),o=()=>{const e=(0,a.useContext)(n);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}}}]);
//# sourceMappingURL=283.f7e2319a.chunk.js.map