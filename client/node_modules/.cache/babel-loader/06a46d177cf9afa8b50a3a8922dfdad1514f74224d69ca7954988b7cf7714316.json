{"ast":null,"code":"import React,{useState}from'react';import{Button,CircularProgress,Avatar,Box,Typography,IconButton}from'@mui/material';import{CameraAlt,Check,ErrorOutline,Delete}from'@mui/icons-material';import api from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ImageUpload(_ref){let{currentUrl,onUploadComplete,type='profile',size=100,disabled=false}=_ref;const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(false);const handleUpload=async e=>{const file=e.target.files[0];if(!file)return;// Validate file\nif(file.size>5*1024*1024){setError('File size must be less than 5MB');return;}setLoading(true);setError(null);setSuccess(false);try{const formData=new FormData();formData.append('image',file);const{data}=await api.post(`/uploads/${type}`,formData,{headers:{'Content-Type':'multipart/form-data'}});onUploadComplete(data.url);setSuccess(true);setTimeout(()=>setSuccess(false),3000);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Upload failed. Please try again.');}finally{setLoading(false);e.target.value='';// Reset file input\n}};const handleRemove=async()=>{try{setLoading(true);await api.delete(`/uploads/${type}`);onUploadComplete('');setSuccess(true);setTimeout(()=>setSuccess(false),3000);}catch(err){setError('Failed to remove image');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsxs(Box,{sx:{position:'relative',width:size,height:size,mb:2},children:[/*#__PURE__*/_jsx(Avatar,{src:currentUrl,sx:{width:'100%',height:'100%',fontSize:size*0.4},children:!currentUrl&&/*#__PURE__*/_jsx(CameraAlt,{fontSize:\"inherit\"})}),loading&&/*#__PURE__*/_jsx(CircularProgress,{size:size*0.5,sx:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)'}})]}),/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",style:{display:'none'},id:`${type}-upload-input`,type:\"file\",onChange:handleUpload,disabled:disabled||loading}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:`${type}-upload-input`,children:/*#__PURE__*/_jsx(Button,{component:\"span\",variant:\"outlined\",color:error?'error':success?'success':'primary',disabled:disabled||loading,startIcon:loading?/*#__PURE__*/_jsx(CircularProgress,{size:20}):success?/*#__PURE__*/_jsx(Check,{}):error?/*#__PURE__*/_jsx(ErrorOutline,{}):/*#__PURE__*/_jsx(CameraAlt,{}),children:loading?'Processing...':error?'Error':success?'Success!':currentUrl?'Change':'Upload'})}),currentUrl&&!disabled&&/*#__PURE__*/_jsx(IconButton,{color:\"error\",onClick:handleRemove,disabled:loading,children:/*#__PURE__*/_jsx(Delete,{})})]}),error&&/*#__PURE__*/_jsx(Typography,{color:\"error\",variant:\"caption\",sx:{mt:1},children:error})]});}","map":{"version":3,"names":["React","useState","Button","CircularProgress","Avatar","Box","Typography","IconButton","CameraAlt","Check","ErrorOutline","Delete","api","jsx","_jsx","jsxs","_jsxs","ImageUpload","_ref","currentUrl","onUploadComplete","type","size","disabled","loading","setLoading","error","setError","success","setSuccess","handleUpload","e","file","target","files","formData","FormData","append","data","post","headers","url","setTimeout","err","_err$response","_err$response$data","response","message","value","handleRemove","delete","sx","display","flexDirection","alignItems","children","position","width","height","mb","src","fontSize","top","left","transform","accept","style","id","onChange","gap","htmlFor","component","variant","color","startIcon","onClick","mt"],"sources":["C:/Users/shori/social-platform/client/src/components/ImageUpload.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { \r\n  Button, \r\n  CircularProgress, \r\n  Avatar, \r\n  Box, \r\n  Typography,\r\n  IconButton \r\n} from '@mui/material';\r\nimport { CameraAlt, Check, ErrorOutline, Delete } from '@mui/icons-material';\r\nimport api from '../utils/api';\r\n\r\nexport default function ImageUpload({ \r\n  currentUrl, \r\n  onUploadComplete, \r\n  type = 'profile',\r\n  size = 100,\r\n  disabled = false\r\n}) {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [success, setSuccess] = useState(false);\r\n\r\n  const handleUpload = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Validate file\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      setError('File size must be less than 5MB');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    setError(null);\r\n    setSuccess(false);\r\n\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('image', file);\r\n      \r\n      const { data } = await api.post(`/uploads/${type}`, formData, {\r\n        headers: { 'Content-Type': 'multipart/form-data' }\r\n      });\r\n      \r\n      onUploadComplete(data.url);\r\n      setSuccess(true);\r\n      setTimeout(() => setSuccess(false), 3000);\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Upload failed. Please try again.');\r\n    } finally {\r\n      setLoading(false);\r\n      e.target.value = ''; // Reset file input\r\n    }\r\n  };\r\n\r\n  const handleRemove = async () => {\r\n    try {\r\n      setLoading(true);\r\n      await api.delete(`/uploads/${type}`);\r\n      onUploadComplete('');\r\n      setSuccess(true);\r\n      setTimeout(() => setSuccess(false), 3000);\r\n    } catch (err) {\r\n      setError('Failed to remove image');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n      <Box sx={{ \r\n        position: 'relative',\r\n        width: size,\r\n        height: size,\r\n        mb: 2\r\n      }}>\r\n        <Avatar\r\n          src={currentUrl}\r\n          sx={{ \r\n            width: '100%', \r\n            height: '100%',\r\n            fontSize: size * 0.4\r\n          }}\r\n        >\r\n          {!currentUrl && <CameraAlt fontSize=\"inherit\" />}\r\n        </Avatar>\r\n        \r\n        {loading && (\r\n          <CircularProgress \r\n            size={size * 0.5}\r\n            sx={{\r\n              position: 'absolute',\r\n              top: '50%',\r\n              left: '50%',\r\n              transform: 'translate(-50%, -50%)'\r\n            }}\r\n          />\r\n        )}\r\n      </Box>\r\n\r\n      <input\r\n        accept=\"image/*\"\r\n        style={{ display: 'none' }}\r\n        id={`${type}-upload-input`}\r\n        type=\"file\"\r\n        onChange={handleUpload}\r\n        disabled={disabled || loading}\r\n      />\r\n      \r\n      <Box sx={{ display: 'flex', gap: 1 }}>\r\n        <label htmlFor={`${type}-upload-input`}>\r\n          <Button\r\n            component=\"span\"\r\n            variant=\"outlined\"\r\n            color={\r\n              error ? 'error' : \r\n              success ? 'success' : \r\n              'primary'\r\n            }\r\n            disabled={disabled || loading}\r\n            startIcon={\r\n              loading ? <CircularProgress size={20} /> :\r\n              success ? <Check /> :\r\n              error ? <ErrorOutline /> :\r\n              <CameraAlt />\r\n            }\r\n          >\r\n            {loading ? 'Processing...' : \r\n             error ? 'Error' : \r\n             success ? 'Success!' : \r\n             currentUrl ? 'Change' : 'Upload'}\r\n          </Button>\r\n        </label>\r\n\r\n        {currentUrl && !disabled && (\r\n          <IconButton\r\n            color=\"error\"\r\n            onClick={handleRemove}\r\n            disabled={loading}\r\n          >\r\n            <Delete />\r\n          </IconButton>\r\n        )}\r\n      </Box>\r\n\r\n      {error && (\r\n        <Typography color=\"error\" variant=\"caption\" sx={{ mt: 1 }}>\r\n          {error}\r\n        </Typography>\r\n      )}\r\n    </Box>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}